/**
 * Animation defines an animation you need to set the sprite via resource,
 * define the frames and call run every frame
 */

//TODO: make it a Class

define(["./core", "./system"],function(core, sys){
	
	$crystal.Animation = core.Class.extend({
		
		init: function(sprite, frames, x, y, w, h){
			this.sprite = (sprite) ? sprite : null;
			this.width = (w) ? w : 64;
			this.height = (h) ? h : 64;
			this.xoff = (x) ? x : 0;
			this.yoff = (y) ? y : 0;
			this.frames = (frames) ? frames : [];
			this.frame = 0;
			this.tickCount = 0;
		},
		update: function(ticks){
			this.tickCount += ticks;
			if(this.frames[this.frame] - this.tickCount <= 0 ){
				this.tickCount -= this.frames[this.frame];
				this.frame = (this.frame + 1) % this.frames.length;				
			}
		},
		draw: function(srf, p, scale){
			if(typeof scale == 'undefined'){
				var scale = 1;
			}
			if(this.sprite){
				var sp= new Point(this.xoff + this.index * this.width, this.yoff );
				srf.drawSprite(this.sprite,this.xoff+this.width*this.frame, this.yoff, this.width, this.height, x, y, this.width*scale, this.height*scale );

			}
		}		
	});
	return $crystal.Animation;
});